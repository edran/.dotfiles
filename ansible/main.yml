---
- hosts: all
  vars:
    - downloads: ~/.ansible-downloads/

    - dockitems_remove:
        - Launchpad
        - Safari
        - Messages
        - Mail
        - Maps
        - Photos
        - FaceTime
        - Calendar
        - Contacts
        - Reminders
        - Notes
        - TV
        - Music
        - Podcasts
        - News
        - Keynote
        - Numbers
        - Pages
        - App Store
        - System Preferences

    - dockitems_persist:
        - name: Google Chrome
          path: /Applications/Google Chrome.app
          pos: 1
        # Pos 2 is Emacs, but homebrew doesn't link emacs from emacsmacport
        # correctly, and simlinks don't seem to be correctly supported by the
        # dock.
        - name: iTerm
          path: /Applications/iTerm.app
          pos: 3
        - name: Slack
          path: /Applications/Slack.app
          pos: 4
        - name: Notion
          path: /Applications/Notion.app
          pos: 5
        - name: Linear
          path: /Applications/Linear.app
          pos: 6
        - name: Spotify
          path: /Applications/Spotify.app
          pos: 7
        - name: Whatsapp
          path: /Applications/Whatsapp.app
          pos: 8
        - name: Signal
          path: /Applications/Signal.app
          pos: 9

    - homebrew_taps:
        - homebrew/core
        - homebrew/cask
        - railwaycat/emacsmacport

    - homebrew_installed_packages:
        # - ansible # Installed via Pip.
        # GNU tools
        - autoconf
        - automake
        - bash # Because MacOS ships with an old version.
        - gpg
        # CLI essentials
        # NOTE: I'd much rather use only hunspell, howerver spell-fu on Emacs
        # does not support generating word lists with anything other than aspell
        # yet.
        - aspell
        - curl
        - { name: emacs-mac, install_options: with-modules }
        - fzf
        - git
        - git-delta
        - github/gh/gh
        - iperf3
        - nmap
        - nnn
        - ssh-copy-id
        - pv # Progress bar for pipes.
        - ripgrep
        - wget
        - tmux
        # Modern CLI tooling
        - angle-grinder # a.k.a. *agrinder*, log analysis.
        - bat # Replaces cat.
        - bottom # a.k.a. *btm*, replaces htop.
        - broot # a.k.a. *br*, replaces tree (?).
        - choose # cut
        - croc # Send files across devices.
        - ctop # Top for containers.
        - difftastic # a.k.a. *difft*, replaces diff.
        - glances # htop, again.
        - glow # Markdown on the terminal.
        - dive # Analyse docker images.
        - dust # du
        - entr # Run arbitrary commands on file changes.
        - exa # ls
        - duf # df
        - fd # find
        - fq # Explore binary files (like jq, ish).
        - fx # Interactive json tool.
        - gdu # ncdu
        - gping # Graphical ping.
        - hexyl # hexdump
        - htmlq # jq for html.
        - httpie # A friendly curl replacement.
        - hyperfine # Benchmarking tool.
        - jc # Convert various tools' output to json.
        - jless # JSON pager.
        - jo # Easily create json objects.
        - jq
        - lazydocker # TUI for docker.
        - lnav # Curses-based log viewing.
        - mtr # traceroute
        - pgcli # psql
        - procs # ps
        - sd # sed
        - tealdeer # A fast tldr client.
        - wrk # HTTP benchmarking.
        - xsv # CSV manipulator.
        - yq # jq for YAML.
        - zoxide # z, fast, autojump
        # Languages
        - go
        - nvm
        - pyenv
        # Fun / useful
        - gifsicle
        - fortune

    - homebrew_cask_appdir: /Applications
    - homebrew_cask_apps:
        - alfred
        - docker
        - discord
        - dropbox
        - firefox
        - google-chrome
        - handbrake
        - iterm2
        - karabiner-elements
        - linear-linear
        - notion
        - signal
        - slack
        - spotify
        - transmit
        - whatsapp
        - zotero

    - mas_installed_apps:
        - { id: 682658836, name: GarageBand }
        - { id: 408981434, name: iMovie }
        - { id: 409201541, name: Pages }
        - { id: 409203825, name: Numbers }
        - { id: 409183694, name: Keynote }
        - { id: 419330170, name: Moom }
        - { id: 1475387142, name: Tailscale }

  roles:
    - role: elliotweiser.osx-command-line-tools
    - role: geerlingguy.mac.homebrew
      tags: [homebrew]
    - role: geerlingguy.mac.mas
      tags: [mas]

  tasks:
    - name: Include Dock role.
      include_role:
        name: geerlingguy.mac.dock
        apply:
          tags: [dock]
      tags: [always]
